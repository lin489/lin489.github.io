<!DOCTYPE html>
<html lang="en" style="overflow:hidden;">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
  <title>地块管理系统</title>
  <link href="Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
  <link href="layui/css/layui.css" rel="stylesheet" />
  <script src="Build/Cesium/Cesium.js"></script>
  <script src="layui/layui.js"></script>
  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.1.min.js"></script>
  <script src="cesiumMeasure.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
  <script src="cameraFly.js"></script>
  <script src="html2canvas.js"></script>
  <script src="recording.js"></script>
  <script src="echart.js"></script>
  <script src="propertiesTable.js"></script>
  <script src="addShp.js"></script>
  <script src="selectShp.js"></script>

  <style>
    html,
    body {
      width: 100%;
      height: 100%;
      margin: 0;
    }

    #checkbox {
      position: absolute;
      z-index: 10;
      width: 400px;
      height: 30px;
      background: rgb(22, 223, 206);
      float: left;
    }

    #menu {
      float: left;
      width: 200px;
      height: calc(100% - 50px);
      overflow: hidden;
      background-color: rgb(85, 25, 61);
      opacity: 0.8;
      position: fixed;
      left: 0;
      z-index: 10;
    }

    #navigationBar {
      float: left;
      width: 100%;
      height: 60px;
      top: 0;
      position: fixed;
      opacity: 1;
      z-index: 100;
    }

    .navigationBar_toolkit {
      top: 60px;
      height: 100px;
      width: 100%;
      position: fixed;
      background-color: #0f2654;
      opacity: 1;
      z-index: 10;
    }

    #bottomBar {
      width: calc(100% - 0px);
      height: 50px;
      bottom: 0;
      opacity: 1;
      position: fixed;
    }

    #cesium {
      float: left;
      width: calc(100% - 0px);
      height: calc(100% - 0px);
      margin: 0;
    }

    #cesiumIcon {
      float: left;
      width: 200px;
      height: 100%;
    }

    #cesiumContainer0 {
      float: left;
      width: 100%;
      height: 100%;
      margin: 0;
    }

    #cesiumContainer1 {
      float: left;
      width: 0%;
      height: 100%;
      margin: 0;
    }

    #cesiumContainer2 {
      float: left;
      width: 0%;
      height: 100%;
      margin: 0;
    }

    #measure {
      position: absolute;
      top: calc(100% - 230px);
      left: 468px;
      width: 50px;
      background-color: #ffffff86;
      box-shadow: inset 1px 2px 2px 0 #f2f6fc;
      color: white
    }

    #recordPanel {
      position: absolute;
      top: calc(100% - 168px);
      left: 308px;
      width: 76px;
      background-color: #ffffff86;
      box-shadow: inset 1px 2px 2px 0 #f2f6fc;
      color: white
    }

    #measureCloseB {
      position: absolute;
      top: 2px;
      right: 0px;
      width: 15px;
      height: 15px;
      margin: 0px;
      border-top: 0px;
      padding: 0px;
      float: right;
    }

    #recordCloseB {
      position: absolute;
      top: 2px;
      right: 0px;
      width: 15px;
      height: 15px;
      margin: 0px;
      border-top: 0px;
      padding: 0px;
      float: right;
    }

    #flyToPos {
      position: absolute;
      top: calc(100% - 266px);
      left: 206px;
      background-color: #ffffff86;
      box-shadow: inset 1px 2px 2px 0 #f2f6fc;
      color: white;

    }

    .jwd {
      position: absolute;
      top: 92%;
      float: left;
      color: chartreuse;
    }

    #recordingIcon {
      float: left;
      position: absolute;
      top: 6%;
      left: 1%;
    }

    #hierarchyPanel {
      position: fixed;
      width: 300px;
      height: 540px;
      left: 30px;
      top: 200px;
      opacity: 0.8;
      background-color: #154149;
    }

    .infoText {
      font-size: 16px;
      color: white;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .layui-tree-txt {
      color: white;

    }

    .cesium-performanceDisplay-defaultContainer {
      z-index: 100;
    }

    .cesium-viewer-toolbar {
      z-index: 100;
    }

    ::-webkit-scrollbar {
      width: 10px;
    }

    ::-webkit-scrollbar-track {
      background-color: #0f2654;
    }

    ::-webkit-scrollbar-thumb {
      background-color: #526ea7;
    }

    .layui-table-hover {
      background-color: #3a8291;
    }

    .layui-table td {
      border-right: 0px;
      border-color: rgb(60, 74, 110);
    }
  </style>

</head>

<body>

  <div style="position: relative; width: 100%;height: 8.1%;opacity: 1;z-index: 100; background-color: #0f2654;">
    <img src="Img/导航栏.png" alt="" style="height: 100%;width: 100%; object-fit: contain;">
    <div>
      <div
        style="position: fixed; left: 10.3%;top: 4.5%; width: 5.8%; height: 3.1%; background-color: #3a8291; z-index: 1000; opacity: 0;"
        onmouseup="ManageDistrict()">
      </div>
      <div
        style="position: fixed; left: 18.0%;top: 4.5%; width: 5.8%; height: 3.1%; background-color: #3a8291; z-index: 1000; opacity: 0;"
        onmouseup="ForestDistrictMode()">
      </div>
      <div
        style="position: fixed; left: 25.1%;top: 4.5%; width: 5.8%; height: 3.1%; background-color: #3a8291; z-index: 1000; opacity: 0;"
        onmouseup="GardenDistrictMode()">
      </div>
    </div>

    <div>
      <div
        style="position: fixed; right: 21.5%;top: 4.5%; width: 9.1%; height: 3.1%; background-color: #3a8291; z-index: 1000; opacity: 0;"
        onmouseup="alert('1')">
      </div>
      <div
        style="position: fixed; right: 11%;top: 4.5%; width: 9.1%; height: 3.1%; background-color: #3a8291; z-index: 1000; opacity: 0;"
        onmouseup="LoadTongHuaTif_2023()">
      </div>
    </div>

    <div id="districtFunction">
      <div
        style="position: fixed; left: 10.4%;top: 7.8%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/添加地块.png" alt="" style="height: 100%;width: 100%; object-fit: contain;" onclick="AddDistrict()">
      </div>
      <div
        style="position: fixed; left: 10.4%;top: 10.2%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/地块筛选.png" alt="" style="height: 100%;width: 100%; object-fit: contain;"
          onclick="SelectDistrict()">
      </div>
      <div
        style="position: fixed; left: 10.4%;top: 12.6%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/地块分析.png" alt="" style="height: 100%;width: 100%; object-fit: contain;"
          onclick="AnalyseDistrict()">
      </div>
    </div>

    <div id="forestDistrictFunction">
      <div
        style="position: fixed; left: 18.1%;top: 7.8%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/普查图斑.png" alt="" style="height: 100%;width: 100%; object-fit: contain;" onclick="ShowForestShp()">
      </div>
    </div>

    <div id="gardenDistrictFunction">
      <div
        style="position: fixed; left: 25.8%;top: 7.8%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/普查图斑.png" alt="" style="height: 100%;width: 100%; object-fit: contain;" onclick="ShowGardenShp()">
      </div>
      <div
        style="position: fixed; left: 25.8%;top: 10.2%; width: 5.8%; height: 3.1%; background-color: #ffffff00; z-index: 1000; opacity: 1;">
        <img src="Img/识别结果.png" alt="" style="height: 100%;width: 100%; object-fit: contain;"
          onclick="ShowAnalysisGardenChart()">
      </div>

    </div>
  </div>

  <!-- Cesium主窗口 -->
  <div id="cesium">
    <div id="cesiumContainer0" class="viewer">
    </div>

    <!-- 测量面板 -->
    <div class="layui-card" id="measure">
      <div class="layui-card-header" style="color:white">量测
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="measureCloseB">
          <i class="layui-icon layui-icon-close"
            style="font-size: 30px;padding: 0px;position:absolute; top: -3px;right: 1px;"></i>
        </button>
      </div>
      <div class="layui-card-body" style="padding: 0px;">
        <button type="button" class="layui-btn layui-btn-sm"
          style="margin: 0px;margin: 2px; margin-top: 4px;margin-bottom: 0px;">距离</button>
        <button type="button" class="layui-btn layui-btn-sm"
          style="margin: 0px;margin: 2px; margin-top: 4px;margin-bottom: 0px;">面积</button>
        <button type="button" class="layui-btn layui-btn-sm"
          style="margin: 0px;margin: 2px; margin-top: 4px;margin-bottom: 0px;">三角</button>
        <button type="button" class="layui-btn layui-btn-primary layui-btn-sm"
          style="margin: 2px; margin-top: 4px;margin-bottom: 0px;">清除</button>
      </div>
    </div>

    <!-- 录制面板 -->
    <div class="layui-card" id="recordPanel">
      <div class="layui-card-header" style="color:white">录制
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="recordCloseB">
          <i class="layui-icon layui-icon-close"
            style="font-size: 30px;padding: 0px;position:absolute; top: -3px;right: 1px;"></i>
        </button>
      </div>
      <div class="layui-card-body" style="padding: 0px;">
        <button type="button" id="recordButton" class="layui-btn layui-btn-sm" onclick="record()"
          style="margin: 0px;margin: 2px; margin-top: 4px;margin-bottom: 0px;">开始录制</button>
        <button type="button" class="layui-btn layui-btn-sm" onclick="download()"
          style="margin: 0px;margin: 2px; margin-top: 4px;margin-bottom: 0px; padding-left: 22px;padding-right: 22px;">下载</button>
      </div>
    </div>

    <!-- 跳转面板 -->
    <div class="layui-card" id="flyToPos">
      <div class="layui-card-header">
        <span style="margin-left: 40px;margin-right: 10px; color: white;">坐标跳转 </span>
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="flyToPosCloseB"><i
            class="layui-icon layui-icon-close" style="font-size: 30px; float: right;"></i> </button>
      </div>
      <form class="layui-form" action="">
        <div class="layui-form-item" style="margin-top: 10px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">经度：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <input style="padding-left: 1px;width: 80px;" type="text" name="longitude" required lay-verify="required"
              placeholder="请输入经度" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px;">纬度：</label>
          <div class="layui-input-block" style="margin-left: 60px;margin-right: 2px;">
            <input style="padding-left: 1px;width: 80px;" type="text" name="latitude" required lay-verify="required"
              placeholder="请输入纬度" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <div class="layui-input-block" style="margin-left: 60px;">
            <button class="layui-btn" lay-submit lay-filter="formDemo">跳转</button>
          </div>
        </div>
      </form>
    </div>
    <!-- 录制中图标 -->
    <div id="recordingIcon" style="left: 220px;">
      <i class="layui-icon layui-icon-circle-dot" style="font-size: 30px; color: #d72cee; float: left;"></i>
      <p style="font-size: 15px; height: 32px;line-height: 32px; color: #1b9fb6; float: left; ">录制中</p>>
    </div>

    <!-- 层级面板 -->
    <div class="layui-card" id="hierarchyPanel">
      <div style="width: 100%; height: 30px;">
        <div style="float: left;height: 100%; margin-left: 120px;"><span
            style=" color: #f2f6fc; text-align: center; font-size: 16px;">层级面板</span></div>
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="hierarchyPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="CloseHierarchyPanel()">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <hr style="margin-top: 4px;margin-bottom: 4px;">
      <div id="hierarchyTree" style="width: 100%; height: calc(100%-38px); "></div>
    </div>

    <!-- WMS影像服务加载面板 -->
    <div class="layui-card" id="webMapServiceLoad"
      style="width: 460px; height: 200px; position:fixed;z-index: 15; opacity: 0.8;background-color: #3a8291 ; left: 40%;top:45%;">

      <div class="layui-card-header">
        <span style="margin-left: 40px;margin-right: 10px; color: white;">影像服务加载(目前默认支持EPSG:4326) </span>
        <div style="float: right;"><button type="button" class="layui-btn layui-btn-primary layui-btn-xs"
            onclick="CloseWebMapServicePanel()"><i class="layui-icon layui-icon-close" style="font-size: 30px; "></i>
          </button>
        </div>
      </div>
      <form class="layui-form" action="">
        <div class="layui-form-item" style="margin-top: 10px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">地址：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <input style="padding-left: 1px;width: 360px;" type="text" name="url" required lay-verify="required"
              placeholder="请输入地址" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item" style="margin-top: 10px;" margin-bottom:0px>
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">图层：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <input style="padding-left: 1px;width: 360px;" type="text" name="layer" required lay-verify="required"
              placeholder="请输入图层名称" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <div class="layui-input-block" style="padding-left: 80px;">
            <button class="layui-btn" lay-submit lay-filter="formWebMapService">确定</button>
          </div>
        </div>
      </form>
    </div>

    <!-- WMTS影像服务加载面板 -->
    <div class="layui-card" id="webMapTileServiceLoad"
      style="width: 460px; height: 220px; position:fixed;z-index: 15; opacity: 0.8;background-color: #3a8291 ; left: 40%;top:45%;">

      <div class="layui-card-header">
        <span style="margin-left: 40px;margin-right: 10px; color: white;">影像服务加载(目前默认支持EPSG:4326) </span>
        <div style="float: right;"><button type="button" class="layui-btn layui-btn-primary layui-btn-xs"
            onclick="CloseWebTileServicePanel()"><i class="layui-icon layui-icon-close" style="font-size: 30px; "></i>
          </button>
        </div>
      </div>
      <form class="layui-form" action="">
        <div class="layui-form-item" style="margin-top: 10px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">地址：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <input style="padding-left: 1px;width: 360px;" type="text" name="url" required lay-verify="required"
              placeholder="请输入地址" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item" style="margin-top: 10px;" margin-bottom:0px>
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">图层：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <input style="padding-left: 1px;width: 360px;" type="text" name="layer" required lay-verify="required"
              placeholder="请输入图层名称" autocomplete="off" class="layui-input">
          </div>
        </div>
        <!-- <div class="layui-form-item" style="margin-top: 10px;"margin-bottom:0px>
        <label class="layui-form-label"
          style="padding-left: 0px;padding-right: 0px; float: left; width: 60px;">tileMatrixLabels：</label>
        <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
          <input style="padding-left: 1px;width: 360px;" type="text" name="tileMatrixLabels" required lay-verify="required"
            placeholder="请输入 tileMatrixLabels" autocomplete="off" class="layui-input">
        </div>
      </div> -->
        <div class="layui-form-item">
          <div class="layui-input-block" style="padding-left: 80px;">
            <button class="layui-btn" lay-submit lay-filter="formWebTileMapService">确定</button>
          </div>
        </div>
      </form>
    </div>


    <!-- UI面板 人参全局 -->
    <div class="layui-card Panel_Left" id="UIPanel_left"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <div style="width: 100%; height: 30px;">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <div id="" style="width: 100%;height: calc(100% - 30px); ">
        <div id="tonghuaEchart" style="width: 100%; height: 33%;"></div>
        <div id="forestLevelEchart" style="width: 100%; height: 33%;"></div>
        <div id="forestOwnerEchart" style="width: 50%; height: 33%; float: left;"></div>
        <div id="gardenOwnerEchart" style="width: 50%; height: 33%; float: left;"></div>
      </div>
    </div>

    <!-- UI面板 林下参 -->
    <div class="layui-card Panel_Left" id="UIPanel_left_forest"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <div style="width: 100%; height: 30px;">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <div id="" style="width: 100%;height: calc(100% - 30px); ">
        <div id="forestEchart" style="width: 100%; height: 33%;"></div>
        <div id="forestOwnerEchart_1" style="width: 50%; height: 33%; float: left;"></div>
        <div id="forestSlopeEchart" style="width: 50%; height: 33%; float: left;"></div>
        <div id="forestAspectEchart" style="width: 40%; height: 33%; float: left;"></div>
        <div id="forestSpeciesEchart" style="width: 60%; height: 33%; float: left;"></div>
      </div>
    </div>

    <!-- UI面板 园参 -->
    <div class="layui-card Panel_Left" id="UIPanel_left_garden"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <div style="width: 100%; height: 30px;">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <div id="" style="width: 100%;height: calc(100% - 30px); ">
        <div id="gardenEchart" style="width: 100%; height: 34%;"></div>
        <div id="gardenAgeEchart" style="width: 100%; height: 33%; float: left;"></div>
        <div id="gardenDistrictKindEchart" style="width: 100%; height: 33%; float: left;"></div>
      </div>
    </div>

    <!-- UI面板 集安 -->
    <div class="layui-card Panel_Left" id="UIPanel_left_JiAn"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <div style="width: 100%; height: 30px;">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <div id="" style="width: 100%;height: calc(100% - 30px); ">
        <div id="JiAnEchart" style="width: 100%; height: 34%;"></div>
        <div id="JiAnOwnerEchart_1" style="width: 50%; height: 33%; float: left;"></div>
        <div id="JiAnSlopeEchart" style="width: 50%; height: 33%; float: left;"></div>
        <div id="JiAnAspectEchart" style="width: 40%; height: 33%; float: left;"></div>
        <div id="JiAnSpeciesEchart" style="width: 60%; height: 33%; float: left;"></div>
      </div>
    </div>

    <!-- UI面板 识别园参 -->
    <div class="layui-card Panel_Left" id="UIPanel_left_Analysis"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <div style="width: 100%; height: 30px;">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
          style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
          <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
        </button>
      </div>
      <div id="" style="width: 100%;height: calc(100% - 30px); ">
        <div id="analysisGardenAmountEchart" style="width: 100%; height: 50%;"></div>
        <div id="analysisGardenAreaEchart" style="width: 100%; height: 50%;"></div>
      </div>
    </div>

        <!-- UI面板 属性选择 -->
        <div class="layui-card Panel_Left" id="UIPanel_left_Select"
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
        <div
          style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
        </div>
        <div style="width: 100%; height: 30px;">
          <button type="button" class="layui-btn layui-btn-primary layui-btn-xs" id="UIPanelCloseB"
            style="float: right; border-color:rgba(61, 124, 179, 0.521);margin: 2px;" onclick="">
            <i class="layui-icon layui-icon-close" style="font-size: 30px; color: rgb(182, 255, 221);"></i>
          </button>
        </div>
        <div id="" style="width: 100%;height: calc(100% - 30px); ">
          <form class="layui-form" action="" style="margin: 20px;">
            <div class="layui-form-item" style="margin-top: 10px;">
              <label class="layui-form-label"
                style="padding-left: 0px;padding-right: 0px; float: left; width: 70px; color: white;">县区：</label>
              <div class="layui-input-block">
                <select name="县区" lay-filter="aihao">
                  <option value="" selected></option>
                  <option value="东昌区">东昌区</option>
                  <option value="二道江区">二道江区</option>
                  <option value="通化县">通化县</option>
                  <option value="辉南县">辉南县</option>
                  <option value="柳河县">柳河县</option>
                  <option value="集安市">集安市</option>
                </select>
              </div>
            </div>
            <hr class="ws-space-16">
            <div class="layui-form-item">
              <label class="layui-form-label"
                style="padding-left: 0px;padding-right: 0px; float: left; width: 70px; color: white;">坡向：</label>
              <div class="layui-input-block">
                <select name="坡向" lay-filter="aihao">
                  <option value="" selected></option>
                  <option value="无坡向">无坡向</option>
                  <option value="东">东</option>
                  <option value="南">南</option>
                  <option value="西">西</option>
                  <option value="北">北</option>
                  <option value="东北">东北</option>
                  <option value="东南">东南</option>
                  <option value="西南">西南</option>
                  <option value="西北">西北</option>
                </select>
              </div>
            </div>
            <hr class="ws-space-16">

            <div class="layui-form-item">
              <label class="layui-form-label"
                style="padding-left: 0px;padding-right: 0px; float: left; width: 70px; color: white;">坡度：</label>
              <div class="layui-input-block">
                <select name="坡度" lay-filter="aihao">
                  <option value="" selected></option>

                  <option value="陡">陡</option>
                  <option value="缓">缓</option>
                  <option value="急">急</option>
                  <option value="平">平</option>
                  <option value="险">险</option>
                  <option value="斜">斜</option>

                </select>
              </div>
            </div>
            <hr class="ws-space-16">


            <div class="layui-form-item">
              <div class="layui-input-block" style="width: 100%; margin-left: 30%;margin-right: 30%;">
                <button class="layui-btn" style="width: 40%;" lay-submit lay-filter="SelectData"
                  onclick="">选择</button>
              </div>
            </div>
          </form>
        </div>
      </div>


    <!-- UI面板 -->
    <div class="layui-card" id="UIPanel_right"
      style="position: fixed;width: 25%;height: 91.9%;right: 0;top: 8.1%;background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;right: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>

      <div id="tableContainer" style="width: 100%; height: calc(100% - 0px); ">
        <div style="width: 100%; height: 100%;">
          <table id="demo" lay-filter="test"></table>
        </div>

      </div>
    </div>

    <!-- 信息面板 -->
    <div class="layui-card" id="dataINFO"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <hr style="margin-top: 2px;margin-bottom: 4px;">
      <form class="layui-form" action="" style="margin: 20px;">
        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 60px; color: white;">县区：</label>
          <div class="layui-input-block" style="margin-left: 60px; margin-right: 2px;">
            <p id="info01" class="infoText">未知</p>
          </div>
        </div>

        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">乡村：</label>
          <div class="layui-input-block" style="margin-left: 60px;margin-right: 2px;">
            <p id="info02" class="infoText">未知</p>
          </div>
        </div>

        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">坡向：</label>
          <div class="layui-input-block" style="margin-left: 40px;margin-right: 2px; transform: translate(5%,0);">
            <p id="info03" class="infoText">未知</p>
          </div>
        </div>

        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">坡度：</label>
          <div class="layui-input-block" style="margin-left: 40px;margin-right: 2px; transform: translate(5%,0);">
            <p id="info04" class="infoText">未知</p>
          </div>
        </div>
        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">面积：</label>
          <div class="layui-input-block" style="margin-left: 40px;margin-right: 2px; transform: translate(5%,0);">
            <p id="info05" class="infoText">未知</p>
          </div>
        </div>
        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">所属：</label>
          <div class="layui-input-block" style="margin-left: 40px;margin-right: 2px; transform: translate(5%,0);">
            <p id="info06" class="infoText">未知</p>
          </div>
        </div>
        <div class="layui-form-item" style="margin-top: 15px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 60px; color: white;">树木类型：</label>
          <div class="layui-input-block" style="margin-left: 40px;margin-right: 2px; transform: translate(5%,0);">
            <p id="info07" class="infoText">未知</p>
          </div>
        </div>
      </form>
    </div>

    <!-- 地块添加面板 -->
    <div class="layui-card" id="AddData"
      style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%; background-color:#fff0;">
      <div
        style="position: fixed;width: 25%;height: 91.9%;left: 0;top: 8.1%;opacity: 0.8;background-color: #0f2654;">
      </div>
      <hr style="margin-top: 2px;margin-bottom: 4px;">
      <form class="layui-form" action="" style="margin: 20px;">
        <div class="layui-form-item" style="margin-top: 10px;">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 70px; color: white;">县区：</label>
          <div class="layui-input-block">
            <select name="县区" lay-filter="aihao">
              <option value="东昌区">东昌区</option>
              <option value="二道江区">二道江区</option>
              <option value="通化县">通化县</option>
              <option value="辉南县">辉南县</option>
              <option value="柳河县">柳河县</option>
              <option value="集安市" selected>集安市</option>
            </select>
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">乡村：</label>
          <div class="layui-input-block">
            <input id="edit02"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9;; border-color: #1b9fb6;"
              type="text" name="乡村" required lay-verify="required" placeholder="请输入乡村" autocomplete="off"
              class="layui-input">
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">所属人：</label>
          <div class="layui-input-block">
            <input id="edit03"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; "
              type="text" name="所属人" required lay-verify="required" placeholder="请输入所属人" autocomplete="off"
              class="layui-input">
          </div>
        </div>
        <hr class="ws-space-16">
        <!-- <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">面积：</label>
          <div class="layui-input-block" >
            <input id="edit04"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; " type="number"
              name="面积" required lay-verify="required" placeholder="请输入面积" autocomplete="off" class="layui-input">
          </div>
        </div> -->
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">租赁周期：</label>
          <div class="layui-input-block">
            <input id="edit05"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; "
              type="number" name="租赁周期" required lay-verify="required" placeholder="请输入租赁周期" autocomplete="off"
              class="layui-input">
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <!-- <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">播种时间：</label>
          <div class="layui-input-block" style="margin-left: 60px;margin-right: 2px;">
            <input id="edit06"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; " type="number"
              name="播种时间" required lay-verify="required" placeholder="请输入播种时间" autocomplete="off" class="layui-input">
          </div> -->

          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left; width: 70px; color: white;">播种时间：</label>
          <div class="layui-input-block">
            <select name="播种时间" lay-filter="aihao">
              <option value="2023" selected>2023</option>
              <option value="2022">2022</option>
              <option value="2021">2021</option>
              <option value="2020">2020</option>
              <option value="2019">2019</option>
              <option value="2018">2018</option>
              <option value="2017">2017</option>
              <option value="2016">2016</option>
            </select>
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">参龄：</label>
          <div class="layui-input-block">
            <input id="edit07"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; "
              type="number" name="参龄" required lay-verify="required" placeholder="请输入参龄" autocomplete="off"
              class="layui-input">
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <label class="layui-form-label"
            style="padding-left: 0px;padding-right: 0px; float: left;width: 70px; color: white;">采收时间：</label>
          <div class="layui-input-block">
            <input id="edit08"
              style="padding-left: 1px;width: calc(100% - 70px); background-color: #c9e5e9; border-color: #1b9fb6; "
              type="number" name="采收时间" required lay-verify="required" placeholder="请输入采收时间" autocomplete="off"
              class="layui-input">
          </div>
        </div>
        <hr class="ws-space-16">
        <div class="layui-form-item">
          <div class="layui-input-block" style="width: 100%; margin-left: 30%;margin-right: 30%;">
            <button class="layui-btn" style="width: 40%;" lay-submit lay-filter="formDataInfo"
              onclick="measure0.drawAreaMeasureGraphics({clampToGround: true})">绘制新图形</button>
          </div>
        </div>
      </form>
    </div>

    <!-- cesium核心及UI -->
    <script>
      // fullScreen();
      //CesiumToken
      Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiMWIxMzA5Zi01YjJlLTQwMWYtYTU5ZS1kMGNjNmM4MGM5MGUiLCJpZCI6OTAxMDAsImlhdCI6MTY1NjY0NTc2MX0.iHMlyEF3E0ticuqktPkYWpsyyqPXZWK-lTUfXxCiTv8';
      //天地图
      const esri = new Cesium.ArcGisMapServerImageryProvider({
        url: 'https://services.arcgisonline.com/ArcGis/rest/services/World_Imagery/MapServer'
      })
      let clampToGround = true
      //viewer0加载
      const viewer0 = new Cesium.Viewer('cesiumContainer0', {

        shouldAnimate: true,
        vrButton: false,
        geocoder: false,
        homeButton: false,
        sceneModePicker: false,
        baseLayerPicker: true,
        navigationHelpButton: false,
        animation: false,
        timeline: false,
        fullscreenButton: false,

        infoBox: false,
        shadows: false,
        selectionIndicator: false,
        //scene3DOnly如果设置为true，则所有几何图形以3D模式绘制以节约GPU资源    
        scene3DOnly: false,
        contextOptions: {
          //cesium状态下允许canvas转图片convertToImage
          webgl: {
            alpha: true,
            depth: false,
            stencil: true,
            antialias: true,
            premultipliedAlpha: true,
            preserveDrawingBuffer: true,
            failIfMajorPerformanceCaveat: true
          },
          allowTextureFilterAnisotropic: true
        },
      });
      //viewer0底图地形
      viewer0.terrainProvider = Cesium.createWorldTerrain({
        requestVertexNormals: true     // 开启地形光照
      });


      viewer0.scene.sun.show = false;
      viewer0.scene.moon.show = false;
      viewer0.scene.skyBox.show = false;

      //帧数显示
      viewer0.scene.debugShowFramesPerSecond = false;

      //测量功能加载
      let measure0 = new Cesium.Measure(viewer0);

      //相机位置初始化
      viewer0.camera.flyTo({
        destination: Cesium.Cartesian3.fromDegrees(125.934696, 41.845546, 403000),
        orientation: {
          heading: Cesium.Math.toRadians(0), // 水平旋转  -正北方向
          pitch: Cesium.Math.toRadians(-90), // 上下旋转  --俯视朝向
          roll: 0 // 视口翻滚角度
        }
      });

      //黑色遮罩
      // var coffeeBeltRectangle = Cesium.Rectangle.fromDegrees(124.934696,40.805546,126.934696,43.085546);
      // viewer0.scene.globe.cartographicLimitRectangle = coffeeBeltRectangle;


      //状态参数
      let flyswtich = true;
      let recordingSwitch = true;
      let viewerState = 1;
      var fullScreenState = false;

      //Cesium窗口尺寸
      var winWidth;
      var winHeight;

      //跳转面板功能实现
      layui.use('form', function () {
        var form = layui.form;
        //监听提交
        form.on('submit(formDemo)', function (data) {
          if (!isNaN(parseFloat(data.field.longitude)) && isFinite(data.field.longitude) && !isNaN(parseFloat(data.field.latitude)) && isFinite(data.field.latitude)) {
            if (data.field.longitude >= -180 && data.field.longitude <= 180 && data.field.latitude >= -90 && data.field.latitude <= 90) {
              flyToByPos(data.field.longitude, data.field.latitude);
            }
          } else {
            layer.msg('请输入数字');
          }
          return false;
        });
      });

      //左下角Credit信息去除
      document.querySelectorAll(".cesium-widget-credits").forEach(credits => {
        credits.style.display = 'none';
      });

      //按钮触发
      $('.layui-card-body button').on('click', function () {
        let text = $(this).text()
        if (text) {
          switch (text) {
            case '距离':
              clampToGround = true;
              measure0.drawLineMeasureGraphics({
                clampToGround: clampToGround,
                callback: () => { }
              });
              break;
            case '面积':
              measure0.drawAreaMeasureGraphics({
                clampToGround: true,
                callback: () => { }
              });
              break;
            case '三角':
              measure0.drawTrianglesMeasureGraphics({
                callback: () => { }
              });
              break;
            case '清除':
              console.log(measure0._drawLayer.entities);
              measure0._drawLayer.entities.removeAll();
              break;
          }
        }
      })
      document.getElementById("recordingIcon").style.display = 'none';
      $('#measureCloseB').on('click', function () {
        document.getElementById("measure").style.display = 'none';

      })
      $('#recordCloseB').on('click', function () {
        document.getElementById("recordPanel").style.display = 'none';

      })
      $('#flyToPosCloseB').on('click', function () {
        document.getElementById("flyToPos").style.display = 'none';
      })
      $('#UIPanelCloseB').on('click', function () {
        document.getElementById("UIPanel").style.display = 'none';
      })

      //测量面板 录像面板 跳转面板 初始化-隐藏
      document.getElementById("measure").style.display = 'none';
      document.getElementById("recordPanel").style.display = 'none';
      document.getElementById("flyToPos").style.display = 'none';


      var v0 = document.getElementById("cesiumContainer0");
    </script>



    <!-- 导航条功能实现 -->
    <script src="navigationBarMethod.js"></script>


    <!-- Entity拾取 -->
    <script src="entityPick.js">

    </script>
    <script src="https://cdn.bootcss.com/FileSaver.js/2014-11-29/FileSaver.js"></script>
    <script src="hierarchyPanel.js"></script>


    <!-- 取点坐标功能 -->
    <!-- <script>
      //取点坐标功能
      let getPosHandler = new Cesium.ScreenSpaceEventHandler(viewer0.scene.canvas);
      //使用时将getPosTrigger激活，左键调用。
      var getPosTrigger = false;
      getPosHandler.setInputAction(function (event) {
        if (getPosTrigger) {
          let ray = viewer0.camera.getPickRay(event.position);
          let cartesian = viewer0.scene.globe.pick(ray, viewer0.scene);
          let cartographic = Cesium.Cartographic.fromCartesian(cartesian);
          let _longitude = Cesium.Math.toDegrees(cartographic.longitude);
          let _latitude = Cesium.Math.toDegrees(cartographic.latitude);
          let _height = cartographic.height;
          let coordinate = {
            longitude: Number(_longitude.toFixed(6)),
            latitude: Number(_latitude.toFixed(6)),
            altitude: Number(_height.toFixed(2))
          };
          layer.msg('经度：' + coordinate.longitude + ', ' + '纬度：' + coordinate.latitude + ',' + '海拔：' + coordinate.altitude + '(已复制到剪切板)');
          const input = document.createElement('input');
          input.setAttribute('readonly', 'readonly');
          input.value = '经度：' + coordinate.longitude + ',' + '纬度：' + coordinate.latitude + ',' + '海拔：' + coordinate.altitude;
          document.body.appendChild(input);
          input.setSelectionRange(0, 9999);
          input.select();
          document.execCommand('copy');
          document.body.removeChild(input);
          getPosTrigger = false;
        }
      }, Cesium.ScreenSpaceEventType.LEFT_CLICK);

      //右下角经纬度数值更新
      let longitudePanel = document.getElementById('longitude-panel');
      let latitudePanel = document.getElementById('latitude-panel');
      let heightPanel = document.getElementById('height-panel');
      viewer0.camera.moveEnd.addEventListener(() => {
        let cameraPosition = viewer0.scene.camera.positionCartographic;
        longitudePanel.innerText = Cesium.Math.toDegrees(cameraPosition.longitude).toFixed(6);
        latitudePanel.innerText = Cesium.Math.toDegrees(cameraPosition.latitude).toFixed(6);
        heightPanel.innerText = cameraPosition.height.toFixed(4);
      });

      //左键获取经纬度
      // let handler = new Cesium.ScreenSpaceEventHandler(viewer0.scene.canvas);
      // handler.setInputAction(function (event) {
      //   let ray = viewer0.camera.getPickRay(event.position);
      //   let cartesian = viewer0.scene.globe.pick(ray, viewer0.scene);
      //   let cartographic = Cesium.Cartographic.fromCartesian(cartesian);
      //   let _longitude = Cesium.Math.toDegrees(cartographic.longitude);
      //   let _latitude = Cesium.Math.toDegrees(cartographic.latitude);
      //   let _height = cartographic.height;
      //   let coordinate = {
      //     longitude: Number(_longitude.toFixed(6)),
      //     latitude: Number(_latitude.toFixed(6)),
      //     altitude: Number(_height.toFixed(2))
      //   };
      //   console.log(coordinate);
      // }, Cesium.ScreenSpaceEventType.LEFT_CLICK);

    </script> -->
    <!-- viewer绑定和其他功能 -->
    <script>

      //Primitive Polyline加载 （废弃）
      function addDataToGlobe_Polyline(features) {
        for (let i = 0; i < features.length; i++) {
          const primitive = new Cesium.GroundPolylinePrimitive({//贴地primitive线
            geometryInstances: new Cesium.GeometryInstance({
              geometry: new Cesium.GroundPolylineGeometry({//贴地线几何
                positions: Cesium.Cartesian3.fromDegreesArray(features[i].coordinates.toString().split(','))
              })
            }),
            appearance: new Cesium.PolylineMaterialAppearance({
              material: Cesium.Material.fromType('Color', {
                color: Cesium.Color.fromRandom(),
              })
            }),
            asynchronous: false,
          })
          viewer0.scene.primitives.add(primitive)
        }
      }
      //量测面板显示
      function measureActive() {
        document.getElementById("measure").style.display = 'block';
      }
      //屏幕截图
      function screenShot() {
        html2canvas(document.querySelector("#cesium")).then(canvas => {
          console.log(canvas);
          let oA = document.createElement("a");
          oA.download = "Cesium截图.png";// 设置下载的文件名，默认是'下载'
          oA.href = canvas.toDataURL('image/png', 1.0);
          document.body.appendChild(oA);
          oA.click();
          oA.remove();
        });
      }
      //全屏
      function fullScreen() {
        console.log(fullScreenState);
        if (fullScreenState == false) {
          var el = document.documentElement;
          var rfs = el.requestFullScreen || el.webkitRequestFullScreen ||
            el.mozRequestFullScreen || el.msRequestFullScreen;
          if (typeof rfs != "undefined" && rfs) {
            rfs.call(el);
          } else if (typeof window.ActiveXObject != "undefined") {
            var wscript = new ActiveXObject("WScript.Shell");
            if (wscript != null) {
              wscript.SendKeys("{F11}");
            }
          }
          fullScreenState = true;
        } else {
          exitFullScreen();
          fullScreenState = false;
        }
      }
      //退出全屏
      function exitFullScreen(el) {
        var el = document
        var cfs = el.cancelFullScreen || el.mozCancelFullScreen || el.msExitFullscreen || el.webkitExitFullscreen ||
          el.exitFullscreen,
          wscript
        if (cfs) {
          cfs.call(el);
          return;
        } else if (typeof window.ActiveXObject !== "undefined") {
          var wscript = new ActiveXObject("WScript.Shell");
          if (wscript != null) {
            wscript.SendKeys("{F11}");
          }
        } else {
          alert('浏览器不支持全屏API或已被禁用')
        }
      }
      //前往指定坐标
      function flyToByPos(longitude, latitude) {
        viewer0.camera.flyTo({
          destination: Cesium.Cartesian3.fromDegrees(longitude, latitude, 5000),
          orientation: {
            heading: Cesium.Math.toRadians(0), // 水平旋转  -正北方向
            pitch: Cesium.Math.toRadians(-90), // 上下旋转  --俯视朝向
            roll: 0 // 视口翻滚角度
          }
        });
      }
      //获取某点坐标
      function getPointCoordinate() {
        layer.msg('左键点击屏幕上任意一点获取经纬度');
        getPosTrigger = true;
      }
      //UI-相关信息按钮绑定方法
      function relevantInformation() {
        layer.msg('基于 Cesium 的田西高速公路多数据三维显示平台 v1.1.2');
      }
      //显示录像面板
      function showRecordPanel() {
        document.getElementById("recordPanel").style.display = 'block';
      }
      //录制状态切换
      function record() {
        if (recordingSwitch) {
          layer.msg('再次点击 视频录制按钮 停止录制');
          startRecord();
          recordingSwitch = false;
          document.getElementById("recordingIcon").style.display = 'block';
          document.getElementById("recordButton").innerText = "停止录制";
        } else {
          stopRecord();
          recordingSwitch = true;
          document.getElementById("recordingIcon").style.display = 'none';
          document.getElementById("recordButton").innerText = "开始录制";
        }
      }
    </script>
    <!-- 数据加载 -->
    <script src="dataLoad.js"></script>

    <script src="UI.js"></script>


    <!-- <script src="geoJsonToJson.js"></script> -->
</body>

</html>